<!-- <form id="formFirma">
    Firma electrónica en formato PKCS12 (archivo .p12):
    <input style="display: block;" type="file" id="archivo_p12" accept="data:application/x-pkcs12">
    <hr>
    Contraseña:
    <input type="text" id="p12password" #p12password>
    <hr>
    Comprobante electrónico a ser firmado:
    <input style="display: block;" type="file" id="archivo_comprobante" xxxaccept="image/*">
    <hr>
    <input type="submit" value="Firmar comprobante electrónico">
    <hr>
    Comprobante electrónico firmado:
    <br>
    <textarea rows="10" cols="50" id="comprobanteFirmado"></textarea>
</form>

<script type="text/javascript" src="../prueba.js">

</script> -->


<div class="factura">
    <div class="tituloFactura">
        <h2>Factura</h2>
        <div class="cabeceraFactura">
            <div class="row">
                <div class="col-sm-3">
                    <span class="spanFactura"><b>Tipo Comprobante: </b></span>

                    <select class="combobox" style="width: 100%; margin: 0; font-size: 14px;" [(ngModel)]="tipocomprobante">
                        <option value="0">Tipo Comprobante</option>
                        <option value="FACTURA">Factura</option>
                        <option value="NOTAVENTA">Nota de venta</option>
                    </select>

                </div>
                <div class="col-sm-2">
                    <span class="spanFactura"><b>Empresa: </b></span>
                    <label class="inputFactura">{{ empresa.nombre_emp }}</label>
                </div>
                <div class="col-sm-3">
                    <span class="spanFactura"><b>Ruc: </b></span>
                    <label class="inputFactura">{{ empresa.ruc_emp }}</label>
                </div>
                <div class="col-sm-2">
                    <span class="spanFactura"><b>Número Factura: </b></span>
                    <label class="inputFactura">{{ secuencial }}</label>
                </div>
                <div class="col-sm-2">
                    <span class="spanFactura"><b>Fecha: </b></span>
                    <label class="inputFactura"> {{ fechaactual }} </label>
                </div>

            </div>
            <span class="spanFactura" style="color: darkorange;"><b>Seleccionar Cliente: </b>
                <svg xmlns="http://www.w3.org/2000/svg" (click)="cargarClientes()" class="svCliente"
                    enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px" fill="#000000">
                    <g>
                        <rect fill="none" height="24" width="24" />
                    </g>
                    <g>
                        <g>
                            <path
                                d="M10,12c2.21,0,4-1.79,4-4c0-2.21-1.79-4-4-4S6,5.79,6,8C6,10.21,7.79,12,10,12z M10,6c1.1,0,2,0.9,2,2c0,1.1-0.9,2-2,2 S8,9.1,8,8C8,6.9,8.9,6,10,6z" />
                            <path
                                d="M4,18c0.22-0.72,3.31-2,6-2c0-0.7,0.13-1.37,0.35-1.99C7.62,13.91,2,15.27,2,18v2h9.54c-0.52-0.58-0.93-1.25-1.19-2H4z" />
                            <path
                                d="M19.43,18.02C19.79,17.43,20,16.74,20,16c0-2.21-1.79-4-4-4s-4,1.79-4,4c0,2.21,1.79,4,4,4c0.74,0,1.43-0.22,2.02-0.57 c0.93,0.93,1.62,1.62,2.57,2.57L22,20.59C20.5,19.09,21.21,19.79,19.43,18.02z M16,18c-1.1,0-2-0.9-2-2c0-1.1,0.9-2,2-2s2,0.9,2,2 C18,17.1,17.1,18,16,18z" />
                        </g>
                    </g>
                </svg>
            </span>


            <div class="row" *ngIf="showCliente">
                <div class="col-sm-2">
                    <span class="spanFactura"><b>Cédula: </b></span>
                    <label class="inputFactura" style="text-align: left;">{{ cliente.ciruc_cli }}</label>
                </div>
                <div class="col-sm-3">
                    <span class="spanFactura"><b>Cliente: </b></span>
                    <label class="inputFactura" style="text-align: left;"> {{ cliente.nombres_cli | titlecase }} {{ cliente.apellidos_cli |
                        titlecase}}</label>
                </div>
                <div class="col-sm-5">
                    <span class="spanFactura"><b>Dirección: </b></span>
                    <label class="inputFactura" style="text-align: left;">{{ cliente.direccion_cli }}</label>
                </div>
                <div class="col-sm-2">
                    <span class="spanFactura"><b>Celular: </b></span>
                    <label class="inputFactura" style="text-align: left;">{{ cliente.telefono_cli }}</label>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-2">
                    <span class="spanFactura"><b>Forma de pago: </b></span>

                    <select class="combobox"  [(ngModel)]="formapago" style="width: 100%; margin: 0; font-size: 14px;">
                        <option value="0">Forma de Pago</option>
                        <option value="01">Efectivo</option>
                        <option value="16">Tarjeta Debito</option>
                        <option value="19">Tarjeta Credito</option>
                        <!-- <option value="CHEQUE">Cheque</option> -->
                    </select>
                </div>
                <div class="col-sm-3">
                    <span class="spanFactura" style="color: #ff8c00;"><b>Vendedor: </b>
                        <!-- <svg xmlns="http://www.w3.org/2000/svg" (click)="loadEmpleadosVentas()" class="svCliente"
                            enable-background="new 0 0 24 24" height="24px" viewBox="0 0 24 24" width="24px"
                            fill="#000000">
                            <g>
                                <rect fill="none" height="24" width="24" />
                            </g>
                            <g>
                                <g>
                                    <path
                                        d="M10,12c2.21,0,4-1.79,4-4c0-2.21-1.79-4-4-4S6,5.79,6,8C6,10.21,7.79,12,10,12z M10,6c1.1,0,2,0.9,2,2c0,1.1-0.9,2-2,2 S8,9.1,8,8C8,6.9,8.9,6,10,6z" />
                                    <path
                                        d="M4,18c0.22-0.72,3.31-2,6-2c0-0.7,0.13-1.37,0.35-1.99C7.62,13.91,2,15.27,2,18v2h9.54c-0.52-0.58-0.93-1.25-1.19-2H4z" />
                                    <path
                                        d="M19.43,18.02C19.79,17.43,20,16.74,20,16c0-2.21-1.79-4-4-4s-4,1.79-4,4c0,2.21,1.79,4,4,4c0.74,0,1.43-0.22,2.02-0.57 c0.93,0.93,1.62,1.62,2.57,2.57L22,20.59C20.5,19.09,21.21,19.79,19.43,18.02z M16,18c-1.1,0-2-0.9-2-2c0-1.1,0.9-2,2-2s2,0.9,2,2 C18,17.1,17.1,18,16,18z" />
                                </g>
                            </g>
                        </svg> -->
                    </span>
                    <label class="inputFactura" style="text-align: left;"> {{ empleado.usuario }} </label>
                </div>
                <div class="col-sm-5">
                </div>
                <div class="col-sm-2">
                </div>
            </div>
        </div>
    </div>

    <div class="detalleFactura">
        <div class="botonesVentas">
            <button class="btn" style="margin: 10px 0 0 10px;" (click)="loadProSer()">Buscar Item<svg
                    xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#FFFFFF">
                    <path d="M0 0h24v24H0V0z" fill="none" />
                    <path
                        d="M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z" />
                </svg>
            </button>
        </div>
        <div
            style="border: 2px solid #fff; width: 98%; margin: 1% 1% 1% 1%; padding: 5px; height: auto; border-radius: 5px;">
            <div class="row">

                <div class="col-sm-2">
                    <span><b>Codigo Barras:</b> </span>
                    <input type="text" style="font-size: 12px;" class="form-control" placeholder="Codigo Barras"
                        (keyup.enter)="cargarItem()" [(ngModel)]="codigobarras">
                </div>

                <div class="col-sm-3">
                    <span><b>Descripción: </b></span>
                    <label class="inputFactura" style="font-size: 14px; text-align: left;">{{ item.nombre_proser
                        }}</label>
                </div>

                <div class="col-sm-3">
                    <div class="row">
                        <div class="col-sm-6">
                            <span><b>Stock:</b> </span>
                            <label class="inputFactura">{{ item.cantidadfinal_proser }}</label>
                        </div>
                        <div class="col-sm-6">
                            <span><b>Precio:</b></span>
                            <label class="inputFactura">{{ item.precio_proser }}</label>
                        </div>
                    </div>
                </div>

                <div class="col-sm-3">
                    <div class="row">
                        <div class="col-sm-6">
                            <span><b>Cantidad:</b> </span>
                            <input type="number" style="text-align: right;" class="form-control" placeholder="Cantidad"
                                [(ngModel)]="cantidaditem" (keyup)="calcularItem()">
                        </div>
                        <div class="col-sm-6">
                            <span><b>Total:</b></span>
                            <label class="inputFactura" style="background-color: #1d1d243b;">{{ totalitem |
                                number:'1.2-2':'fr'}}</label>
                        </div>
                    </div>
                </div>
                <div class="col-sm-1">
                    <span style="font-size: 14px;"><b>Añadir</b></span>
                    <span title="Añadir Item" (click)="sumarItem()">
                        <svg xmlns="http://www.w3.org/2000/svg" class="btn btngrabar" style="margin: 0; float: none;"
                            height="24px" viewBox="0 0 24 24" width="24px" fill="#FFFFFF">
                            <path d="M0 0h24v24H0V0z" fill="none" />
                            <path
                                d="M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z" />
                        </svg>
                    </span>

                </div>
            </div>
        </div>

        <div class="itemscompras">

            <div class="mat-elevation-z8" >

                <mat-table [dataSource]="dataSource" matSort>
              
                    <!-- 'nombre','descripcion','cantidad','precio','eliminar', -->

                  <ng-container matColumnDef="nombre" >
                    <mat-header-cell *matHeaderCellDef mat-sort-header> Nombre </mat-header-cell>
                    <mat-cell *matCellDef="let row" data-label="Nombre"> 
                        <b>{{ row.nombre_proser | titlecase}}</b> 
                    </mat-cell>
                  </ng-container>
              
                  <ng-container matColumnDef="descripcion">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> Descripción </mat-header-cell>
                    <mat-cell *matCellDef="let row" data-label="Descripción"> 
                        {{ row.descripcion_proser }} 
                    </mat-cell>
                  </ng-container>
              
                  <ng-container matColumnDef="cantidad">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> Cantidad </mat-header-cell>
                    <mat-cell *matCellDef="let row" data-label="Cantidad"> 
                        {{ row.cantidadvendida }} 
                    </mat-cell>
                  </ng-container>
              
                  <ng-container matColumnDef="precio">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> Subtotal </mat-header-cell>
                    <mat-cell *matCellDef="let row" data-label="Precio"> 
                        {{ row.total  | number:'1.2-2':'fr' }} $
                    </mat-cell>
                  </ng-container>
        
                  <ng-container matColumnDef="eliminar">
                    <mat-header-cell *matHeaderCellDef mat-sort-header> Eliminar </mat-header-cell>
                    <mat-cell *matCellDef="let row" data-label="Eliminar"> 
                        <button (click)="borrarItems(row)" mat-icon-button>
                            <mat-icon color="warn">delete</mat-icon>
                          </button>
                    </mat-cell>
                  </ng-container>
              
                  <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
                  <mat-row *matRowDef="let row; columns: displayedColumns;">
                  </mat-row>
                </mat-table>
              
            </div>

            <div class="row">
                <div class="col-sm-6">

                </div>
                <div class="col-sm-6">
                    <div class="row">
                        <div class="col-sm-4"></div>
                        <div class="col-sm-8">
                            <br>
                            <div class="camposcompras">
                                <label>Subtotal 12%</label>

                                <label class="inputFactura" style="font-weight: 500; font-size: 16px;">
                                    {{ subtotal12 | number:'1.2-2':'fr'}}</label>

                                <!-- <input style="text-align: right;" type="number"
                                    [(ngModel)]="subtotal12" disabled> -->
                            </div>
                            <div class="camposcompras">
                                <label>Subtotal 0%</label>

                                <label class="inputFactura" style="font-weight: 500; font-size: 16px;">
                                    {{ subtotal0 | number:'1.2-2':'fr'}}</label>

                                <!-- <input style="text-align: right;" type="number"
                                    [(ngModel)]="subtotal0" disabled> -->
                            </div>
                            <div class="camposcompras">
                                <label>IVA 12%</label>

                                <label class="inputFactura" style="font-weight: 500; font-size: 16px;">
                                    {{ iva | number:'1.2-2':'fr'}}</label>

                                <!-- <input style="text-align: right;" type="number" [(ngModel)]="iva"
                                    disabled> -->
                            </div>
                            <div class="camposcompras">
                                <label>Total</label>
                                <label class="inputFactura" style="font-size: 16px;">
                                    {{ totalFactura | number:'1.2-2':'fr'}}</label>

                                <!-- <input style="text-align: right;" type="number"
                                    [(ngModel)]="totalFactura" disabled> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <br>
            <div class="row">
                <div class="col-sm-12">
                    <button class="btn btncancelar">
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"
                            fill="#FFFFFF">
                            <path d="M0 0h24v24H0V0z" fill="none" opacity=".87" />
                            <path
                                d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.59-13L12 10.59 8.41 7 7 8.41 10.59 12 7 15.59 8.41 17 12 13.41 15.59 17 17 15.59 13.41 12 17 8.41z" />
                        </svg>
                        Cancelar </button>

                    <button class="btn btngrabar" (click)="grabarFactura()">
                        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"
                            fill="#FFFFFF">
                            <path d="M0 0h24v24H0V0z" fill="none" />
                            <path
                                d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm2 16H5V5h11.17L19 7.83V19zm-7-7c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3zM6 6h9v4H6z" />
                        </svg> Registrar Factura </button>
                </div>
            </div>
        </div>
    </div>
</div>